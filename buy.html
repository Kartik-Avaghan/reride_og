<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/nav.css">
        <link rel="stylesheet" href="./css/buy.css">
        <link rel="stylesheet" href="./css/footer.css">
        

</head>

<body>
    <!-- Header -->
    <header class="header">
  <div class=" d-flex  justify-content-between align-items-start">
    
    <!-- Logo -->
    <a href="index.html" class="logo">
      <img src="./images/home/Reride_Logo.png" alt="Reride Logo" />
    </a>

    <!-- Right side: Hamburger + Nav -->
    <div class="d-flex flex-column align-items-end">
      <!-- Hamburger -->
      <button class="hamburger d-lg-none ms-3" id="hamburger">&#9776;</button>
      
      <!-- Navigation -->
      <nav class="nav" id="navMenu">
        <ul class="nav__list">
          <!-- Search -->
          <li class="nav-item">
            <div class="search-container">
              <input type="text" placeholder="Search" class="nav-search-input" id="indexSearch" />
              <button class="search-btn" onclick="indexSearch()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="#fff" width="16" height="16"
                  viewBox="0 0 24 24">
                  <path d="M10,2A8,8 0 1,0 18,10A8,8 0 0,0 10,2M22,22L17,17" 
                        stroke="white" stroke-width="2" 
                        stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </button>
            </div>
          </li>
          <!-- Links -->
          <li class="nav-item"><a href="./index.html" class="nav-link">Home</a></li>
          <li class="nav-item"><a href="./aboutUs.html" class="nav-link  ">About Us</a></li>
          <li class="nav-item"><a href="./buy.html" class="nav-link active">Buy</a></li>
          <li class="nav-item"><a href="./sell.html" class="nav-link ">Sell</a></li>
          <li class="nav-item"><a href="./contact.html" class="nav-link ">Contact</a></li>
        </ul>
      </nav>
    </div>
  </div>
</header>

    <div class="slide_1" style="margin-bottom: 5%;padding-top: 2%;background-color: #FAF2F0;">
        <div class="main_3 w-100 clearfix">
            <section id="booking">
                <div class="container-xl">
                    <div class="booking_m clearfix" style="background-color: #FAF2F0;padding-bottom: 2%;">
                        <div class="row booking_1">
                            <div class="col-md-12">
                                <h4 class="mb-0">Book Your Vehicle</h4>
                            </div>
                        </div>
                        <div class="row booking_2 mt-4">
                            <div class="col-md-3 col-sm-6">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-map-marker me-1 col_oran"></i>Select Location
                                    </h6>
                                    <select class="form-select" id="select-location">
                                        <option>Select Location</option>
                                        <option>Jalhalli</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-car me-1 col_oran"></i>Select Vehicle Brand
                                    </h6>
                                    <select class="form-select" id="select-brand">
                                        <option>Select Vehicle Brand</option>
                                        <option>Bajaj</option>
                                        <option>Hero</option>
                                        <option>Honda</option>
                                        <option>Mahindra</option>
                                        <option>Suzuki</option>
                                        <option>TVS</option>
                                        <option>Vespa</option>
                                        <option>Yamaha</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-car me-1 col_oran"></i>Search Type</h6>
                                    <select class="form-select" id="select-type">
                                        <option>Seach Type</option>
                                        <option>BIKE</option>
                                        <option>SCOOTER</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-6 mb-3">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-map-marker me-1 col_oran"></i>Model Name</h6>
                                    <select class="form-select" id="select-model" disabled>
                                        <option value="">Select Model</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row booking_2 mt-4">
                            <div class="col-md-3 col-sm-6">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-money me-1 col_oran"></i>Price</h6>
                                    <div class="booking_2i1 row">
                                        <div class="col-md-8">
                                            <div class="booking_2i1l">
                                                <input class="form-control" id="price" type="text" name="price"
                                                    placeholder="ex: less than 50000rs">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-calendar me-1 col_oran"></i>Model Year</h6>
                                    <div class="booking_2i1 row">
                                        <div class="col-md-8">
                                            <div class="booking_2i1l">
                                                <input class="form-control" id="modelYear" type="number"
                                                    placeholder="ex: 2020 and after" min="1900" max="2100"
                                                    name="modeYear">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-6">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-calendar me-1 col_oran"></i>Mileage</h6>
                                    <div class="booking_2i1 row">
                                        <div class="col-md-8">
                                            <div class="booking_2i1l">
                                                <input class="form-control" id="mileage" type="text" name="mileage"
                                                    placeholder="ex: 20kmpl and greater">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-12">
                                <div class="booking_2i">
                                    <h6 class="mb-3"><i class="fa fa-search me-1 col_oran"></i> Find</h6>
                                    <h6 class="text-center mb-0"><a class="button  d-block btn"
                                            style="background-color: #0A1F58;color: white;" href="#"
                                            onclick="searchVehicle()">Search</a>
                                    </h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    <div class="container" id="cards-wrapper">
        <a class="button  d-block btn" style="background-color: #0A1F58;color: white;width: 10%;display: flex;justify-self: flex-end;margin-bottom: 1%;" href="./buy.html">Clear</a>
        <div id="results" class="row g-3"></div>
    </div>

    <div id="incoming-search-display" style="margin: 1em 0; font-weight: bold;"></div>
    <!-- Footer -->
    <footer>
        <p>&copy; 2025 <strong style="color: #0A1F58;">ReRide</strong>.</p>
    </footer>
</body>
<script src="./js/buy/buy.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
    crossorigin="anonymous"></script>
    <script src="./js/nav.js"></script>


<script>
    // parse query string
    function getQueryParam(name) {
        const params = new URLSearchParams(window.location.search);
        return params.get(name);
    }

    let vehiclesData = [];

    function parseNum(v) {
        if (v == null || v === '' || v === 'N/A') return null;
        const n = Number(String(v).replace(/,/g, '').trim());
        return isNaN(n) ? null : n;
    }

    function clean(el, placeholderRegex) {
        if (!el) return '';
        const v = el.value.trim();
        if (!v || (placeholderRegex && placeholderRegex.test(v))) return '';
        return v;
    }

    // load JSON
    fetch('./json/vehicles.json')
        .then(r => {
            if (!r.ok) throw new Error('Failed to load vehicles.json');
            return r.json();
        })
        .then(d => {
            vehiclesData = Array.isArray(d.vehicles) ? d.vehicles : [];
            // if there's a query param, optionally inject into a search box
            const searchTerm = getQueryParam('q');
            if (searchTerm) {
                const input = document.getElementById('sellSearch');
                if (input) input.value = decodeURIComponent(searchTerm);
            }
            applyFiltersAndRender();
        })
        .catch(err => {
            console.error(err);
            const container = document.getElementById('results');
            if (container) container.innerHTML = '<div class="col-12">Unable to load vehicles.</div>';
        });

    function buildCard(v) {
        const title = `${v.Brand || ''} ${v.modelName || ''}`.trim();
        const price = v.price != null ? v.price : 'N/A';
        const type = v.type || 'N/A';
        const modelYear = v["Model Year"] || 'N/A';
        const mileage = v.actualKms || v.correctedKms || 'N/A';
        const owner = v["Owner Type"] || 'N/A';
        const reg = v["Vehicle Reg No"] || '';
        const imgSrc = v.img || '';

        const wrapper = document.createElement('div');
        wrapper.className = 'col-12 col-sm-6 col-md-3'; // 4 per row on md+
//         wrapper.innerHTML = `
//       <div class="model_m  clearfix   " style="background-color: #fff;">
//         ${imgSrc ? `<div style="text-align:center; ">
//           <img src="${imgSrc}" alt="${title}" style=" height:200px;  width:280px;  " />
//         </div>` : ''}
//         </div>
//         <div style="width:93%;text-align:start; padding:8px; border-top: 1px solid rgb(218, 112, 214);
// border-right: 1px solid rgb(218, 112, 214);
// border-left: 1px solid rgb(218, 112, 214); border-radius:10px 10px 0 0; background-color:rgb(216, 202, 216); height:40px; color:rgb(218, 112, 214); font-size:14px" >DriveX Assured</div>


// <div style="border:1px solid gray; border-radius:12px; width:100%; padding:10px;">
//         <div class="model_pg1i2 row">
//           <div class="col-6">
//             <div class="model_pg1i2l">
//               <h3 style="font-size: 20px; margin:0;">${title}</h3>
//               <span class="font_12 col_yell">
//                 <i class="fa fa-star"></i><i class="fa fa-star"></i>
//                 <i class="fa fa-star"></i><i class="fa fa-star"></i>
//                 <i class="fa fa-star-half-o"></i>
//               </span>
//             </div>
//           </div>
//           <div class="col-6">
//             <div class="model_pg1i2r text-end">
//               <h3 class="mb-1"><i class="fa fa-rupee col_oran"></i> ${price}</h3>
//               <h6 class="mb-0 font_14">price</h6>
//             </div>
//           </div>
//         </div>
//         <div class="model_pg1i3 row mt-3 mb-3">
//           <div class="col-6">
//             <div class="model_pg1i3l">
//               <h6><i class="fa fa-car col_oran me-1"></i> ${type}</h6>
//               <h6 class="mb-0 mt-2"><i class="fa fa-calendar col_oran me-1"></i>Model Year:${modelYear}</h6>
//             </div>
//           </div>
//           <div class="col-6">
//             <div class="model_pg1i3l text-end">
//               <h6><i class="fa fa-tachometer col_oran me-1"></i> Mileage: ${mileage}</h6>
//               <h6 class="mb-0 mt-2"><i class="fa fa-user col_oran me-1"></i> Owner: ${owner}</h6>
//             </div>
//           </div>
//         </div>
//         <hr>
//         <div class="model_pg1i4 row text-center mt-2">
//           <div class="col-12">
//             <p class="mb-1"><small>Reg No: ${reg}</small></p>
//             <h6 class="mb-0">
//               <a class="button btn" href="#">Book Ride <i class="fa fa-check-circle ms-1"></i></a>
//             </h6>
//           </div>
//         </div>
//       </div>
//     `;






wrapper.innerHTML = `
  <div class="model_m clearfix" style="background-color:#fff;">

    ${imgSrc ? `
      <div style="text-align:center;">
        <img src="${imgSrc}" alt="${title}" style="height:200px; width:280px;  border-radius:10px 10px 0 0; box-shadow:0 2px 10px rgba(0,0,0,0.1);" />
      </div>` : ''}

    <!-- DriveX Assured strip -->
    <div style="
      text-align:start; 
      padding:8px; 
      border-top:1px solid rgb(240, 225, 225);
      border-right:1px solid rgb(240, 225, 225);
      border-left:1px solid rgb(240, 225, 225); 
      border-radius:10px 10px 0 0; 
      background-color:#FAF2F0; 
      height:40px; 
      width:95%;
       
      font-size:14px;
      margin:0 auto; 
      display:block;
      ">
      Re-Ride Assured
    </div>

    <!-- Main container -->
    <div style=" border-bottom:1px solid black width:100%;
     border:1px solid black; border-radius:8px; padding:10px; margin:0 auto; display:block;">
      
      <!-- Title & Price -->
      <div class="model_pg1i2 row" style="margin:0;">
        <div class="col-6">
          <div class="model_pg1i2l">
            <h5 style="font-size:20px; margin:0;">${title}</h5>
            <span class="font_12 col_yell">
              <i class="fa fa-star"></i><i class="fa fa-star"></i>
              <i class="fa fa-star"></i><i class="fa fa-star"></i>
              <i class="fa fa-star-half-o"></i>
            </span>
          </div>
        </div>
        <div class="col-6 text-end">
          <h3 class="mb-1"><i class="fa fa-rupee col_oran"></i> ${price}</h3>
          <h6 class="mb-0 font_14">price</h6>
        </div>
      </div>

      <!-- Specs -->
      <div class="model_pg1i3 row mt-1 mb-1" style="margin:0;">
        <div class="col-6">
          <h6><i class="fa fa-car col_oran me-1"></i> ${type}</h6>
          <h6 class="mb-0 mt-2"><i class="fa fa-calendar col_oran me-1"></i> Model Year: ${modelYear}</h6>
        </div>
        <div class="col-6 text-end">
          <h6><i class="fa fa-tachometer col_oran me-1"></i> Mileage: ${mileage}</h6>
          <h6 class="mb-0 mt-1"><i class="fa fa-user col_oran me-1"></i> Owner: ${owner}</h6>
        </div>
      </div>

      <hr>

      <!-- Footer -->
      <div class="model_pg1i4 row text-center " style="margin:0;">
        <div class="col-12">
          <p class="mb-1"><small>Reg No: ${reg}</small></p>
         <h6 class="mb-0">
  <a class="book-btn" href="#">Book Ride <i class="fa fa-check-circle ms-1"></i></a>
</h6>
        </div>
      </div>

    </div>
  </div>
`;





        return wrapper;
    }

    function applyFiltersAndRender() {
        const brand = clean(document.getElementById('select-brand'), /^Select\s+Vehicle\s+Brand$/i).toLowerCase();
        const model = clean(document.getElementById('select-model'), /^Select\s+Model$/i).toLowerCase();
        const type = clean(document.getElementById('select-type'), /^Seach\s+Type$/i).toLowerCase();
        const priceInput = (document.getElementById('price')?.value || '').trim();
        const modelYearInput = (document.getElementById('modelYear')?.value || '').trim();
        const mileageInput = (document.getElementById('mileage')?.value || '').trim();
        const searchTermRaw = getQueryParam('q') || '';
        const freeText = searchTermRaw.trim().toLowerCase();

        const maxPrice = parseNum(priceInput);
        const minYear = parseNum(modelYearInput);
        const minMileage = parseNum(mileageInput);

        const filtered = vehiclesData.filter(v => {
            if (brand && (!v.Brand || v.Brand.toLowerCase() !== brand)) return false;
            if (model && (!v.modelName || v.modelName.toLowerCase() !== model)) return false;
            if (type && (!v.type || v.type.toLowerCase() !== type)) return false;
            if (maxPrice != null) {
                const vp = parseNum(v.price);
                if (vp == null || !(vp < maxPrice)) return false;
            }
            if (minYear != null) {
                const vy = parseNum(v["Model Year"]);
                if (vy == null || !(vy > minYear)) return false;
            }
            if (minMileage != null) {
                const vm = parseNum(v.actualKms ?? v.correctedKms ?? '');
                if (vm == null || !(vm > minMileage)) return false;
            }
            if (freeText) {
                const matches = [
                    v.Brand,
                    v.modelName,
                    v.type,
                    v["Vehicle Reg No"],
                    v["Owner Type"],
                    v["Model Year"],
                    v["Purchased.Date"]
                ].some(field => {
                    if (field == null) return false;
                    return String(field).toLowerCase().includes(freeText);
                });
                if (!matches) return false;
            }
            return true;
        });

        const container = document.getElementById('results');
        if (!container) return;
        container.innerHTML = '';
        if (!filtered.length) {
            container.innerHTML = '<div class="col-12"><div class="alert alert-warning">No vehicles found.</div></div>';
            return;
        }
        filtered.forEach(v => container.appendChild(buildCard(v)));
    }

    // optional: update on filter change
    ['select-brand', 'select-model', 'select-type', 'price', 'modelYear', 'mileage'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.addEventListener('change', applyFiltersAndRender);
    });

    // on load also reflect URL param search if any (e.g., user might want immediate free-text)
    document.addEventListener('DOMContentLoaded', applyFiltersAndRender);
</script>






</html>